<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="sec.css">
    <script src="https://kit.fontawesome.com/3329bf17c6.js"></script>
</head>
<body>
  <header>
    <div class="logo">
      <h2>Cricket<span>pulse</span></h2>
    </div>
    <div class="navbar">
      <ul>
        <li><a href="#Home">Home</a></li>
        <li><a href="">Venue</a></li>
        <li><a href="">Players</a></li>
        <li><a href="">About</a></li>
        <li><button id="singout">signout</button></li>
        <li><a href="detail.html">Details</a></li>
      </ul>
    </div>
  </header>
  <section id="Home">
    <div class="container">
      <form action="#" id="frm">
        <label for="text">Name</label>
        <input type="name" name="username" id="name" placeholder="Enter your name">
        <span id="name-error"></span>
        <label for="name">AGE</label>
        <input type="number" id="age"placeholder="Enter your age">
        <span id="person-error"></span>
        <label for="text">Mobile Number</label>
        <input type="tel" id="phoneNumber" placeholder="Enter your mobile number">
        <span id="phone-error"></span>
        <label for="text">City</label>
        <input type="text" id="city" placeholder="Enter your city">
        <span id="city-error"></span>
        <button type="submit" id="submit">Submit</button>
      </form>
    </div>
    <div class="row">

    </div>
  </section>




  <script type="module">

      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
// signout functions
      import { getAuth,onAuthStateChanged,signOut} from "https://www.gstatic.com/firebasejs/11.10.0/firebase-auth.js";
//database function data store
      import { getDatabase,ref,push,set} from "https://www.gstatic.com/firebasejs/11.10.0/firebase-database.js";
//API keys
  const firebaseConfig = {
    apiKey: "AIzaSyDOX6gaBb9B9iVJDP3JSyrEKjOZ7ij30DE",
    authDomain: "log-in-authentication-7a152.firebaseapp.com",
    projectId: "log-in-authentication-7a152",
    storageBucket: "log-in-authentication-7a152.firebasestorage.app",
    messagingSenderId: "659156202599",
    appId: "1:659156202599:web:9d698cd651f94c35e9d0c2",
    measurementId: "G-9PBLGX5VCY",
    databaseURL:"https://log-in-authentication-7a152-default-rtdb.firebaseio.com/"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db=getDatabase(app);

  const signOutButton=document.getElementById("singout")


onAuthStateChanged(auth,(user)=>{
  if(!user){
    window.location.href="index.html"
  }
})
signOutButton.addEventListener('click',async()=>{
      await signOut(auth);
      localStorage.removeItem("auth");
      window.location.href='index.html'
     });





document.getElementById("frm").addEventListener('submit',function(e){
  e.preventDefault();


  const userName=document.getElementById("name").value.trim();
  const userAge=document.getElementById("age").value.trim();
  const phoneNumber=document.getElementById("phoneNumber").value.trim();
  const userCity=document.getElementById("city").value.trim();
  const frmSubmit=document.getElementById("frm")

//error messages
    document.getElementById("name-error").innerText="";
    document.getElementById("person-error").innerText="";
    document.getElementById("phone-error").innerText="";
    document.getElementById("city-error").innerText="";


  let isValid=true;

  //name validation
  if(userName===""){
    document.getElementById("name-error").innerText="Name is required";
    isValid=false;
  }
  //age validation
  if(userAge===""){
    document.getElementById("person-error").innerText="Age is required";
    isValid=false;
  }
  
  //mobilenumber validation
  if(!/^\d{10}$/.test(phoneNumber)){
    document.getElementById("phone-error").innerText="Enter valid phoneNumber";
    isValid=false;
  }
  //city validation
  if(userCity ===""){
    document.getElementById("city-error").innerText="Enter your city";
    isValid=false;
  }
  if(isValid){
    const userRef=ref(db,'users');
    const newUserRef=push(userRef);
    const userData={
      name:userName,
      age:userAge,
      phoneNumber:phoneNumber,
      city:userCity
    }
    
    set( newUserRef,userData)
    .then(()=>{
      alert('Data submitted successfully!');
      frmSubmit.reset();
      Window.location.href="detail.html"
    })
    
  }
  
})


</script>
</body>
</html>